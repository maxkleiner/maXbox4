unit uPSI_JvAppUtils;
{
This file has been generated by UnitParser v0.7, written by M. Knight
and updated by NP. v/d Spek and George Birbilis. 
Source Code from Carlo Kok has been used to implement various sections of
UnitParser. Components of ROPS are used in the construction of UnitParser,
code implementing the class wrapper is taken from Carlo Kok's conv utility

}
interface
 
uses
   SysUtils
  ,Classes
  ,uPSComponent
  ,uPSRuntime
  ,uPSCompiler
  ;
 
type 
(*----------------------------------------------------------------------------*)
  TPSImport_JvAppUtils = class(TPSPlugin)
  protected
    procedure CompileImport1(CompExec: TPSScript); override;
    procedure ExecImport1(CompExec: TPSScript; const ri: TPSRuntimeClassImporter); override;
  end;
 
 
{ compile-time registration functions }
procedure SIRegister_JvAppUtils(CL: TPSPascalCompiler);

{ run-time registration functions }
procedure RIRegister_JvAppUtils_Routines(S: TPSExec);

procedure Register;

implementation


uses
   Windows
  ,Registry
  ,Controls
  ,Forms
  ,Grids
  ,IniFiles
  ,RTLConsts
  ,JvVCLUtils_max
  ,JvAppUtils
  ;
 
 
procedure Register;
begin
  RegisterComponents('Pascal Script', [TPSImport_JvAppUtils]);
end;

(* === compile-time registration functions === *)
(*----------------------------------------------------------------------------*)
procedure SIRegister_JvAppUtils(CL: TPSPascalCompiler);
begin
 CL.AddDelphiFunction('Function GetDefaultSection( Component : TComponent) : string');
 CL.AddDelphiFunction('Procedure GetDefaultIniData( Control : TControl; var IniFileName, Section : string; UseRegistry : Boolean)');
 CL.AddDelphiFunction('Procedure GetDefaultIniData( Control : TControl; var IniFileName, Section : string)');
 CL.AddDelphiFunction('Function GetDefaultIniName : string');
 //CL.AddConstantN('OnGetDefaultIniName','TOnGetDefaultIniName').SetString();
 CL.AddDelphiFunction('Function GetDefaultIniRegKey : string');
 CL.AddDelphiFunction('Function FindForm( FormClass : TFormClass) : TForm');
 CL.AddDelphiFunction('Function FindShowForm( FormClass : TFormClass; const Caption : string) : TForm');
 CL.AddDelphiFunction('Function ShowDialog( FormClass : TFormClass) : Boolean');
 //CL.AddDelphiFunction('Function InstantiateForm( FormClass : TFormClass; var Reference) : TForm');
 CL.AddDelphiFunction('Procedure SaveFormPlacement( Form : TForm; const IniFileName : string; UseRegistry : Boolean)');
 CL.AddDelphiFunction('Procedure RestoreFormPlacement( Form : TForm; const IniFileName : string; UseRegistry : Boolean)');
 //CL.AddDelphiFunction('Procedure WriteFormPlacementReg( Form : TForm; IniFile : TRegIniFile; const Section : string)');
 //CL.AddDelphiFunction('Procedure ReadFormPlacementReg( Form : TForm; IniFile : TRegIniFile; const Section : string; LoadState, LoadPosition : Boolean)');
 //CL.AddDelphiFunction('Procedure SaveMDIChildrenReg( MainForm : TForm; IniFile : TRegIniFile)');
 //CL.AddDelphiFunction('Procedure RestoreMDIChildrenReg( MainForm : TForm; IniFile : TRegIniFile)');
 //CL.AddDelphiFunction('Procedure RestoreGridLayoutReg( Grid : TCustomGrid; IniFile : TRegIniFile)');
 //CL.AddDelphiFunction('Procedure SaveGridLayoutReg( Grid : TCustomGrid; IniFile : TRegIniFile)');
 CL.AddDelphiFunction('Procedure SaveFormPlacement( Form : TForm; const IniFileName : string)');
 CL.AddDelphiFunction('Procedure RestoreFormPlacement( Form : TForm; const IniFileName : string)');
 {CL.AddDelphiFunction('Procedure WriteFormPlacement( Form : TForm; IniFile : TCustomIniFile; const Section : string)');
 CL.AddDelphiFunction('Procedure ReadFormPlacement( Form : TForm; IniFile : TCustomIniFile; const Section : string; LoadState, LoadPosition : Boolean)');
 CL.AddDelphiFunction('Procedure SaveMDIChildren( MainForm : TForm; IniFile : TCustomIniFile)');
 CL.AddDelphiFunction('Procedure RestoreMDIChildren( MainForm : TForm; IniFile : TCustomIniFile)');
 CL.AddDelphiFunction('Procedure RestoreGridLayout( Grid : TCustomGrid; IniFile : TCustomIniFile)');
 CL.AddDelphiFunction('Procedure SaveGridLayout( Grid : TCustomGrid; IniFile : TCustomIniFile)');}
 CL.AddDelphiFunction('Function GetUniqueFileNameInDir( const Path, FileNameMask : string) : string');
 CL.AddDelphiFunction('Function StrToIniStr( const Str : string) : string');
 CL.AddDelphiFunction('Function IniStrToStr( const Str : string) : string');
 CL.AddDelphiFunction('Function IniReadString( IniFile : TObject; const Section, Ident, Default : string) : string');
 CL.AddDelphiFunction('Procedure IniWriteString( IniFile : TObject; const Section, Ident, Value : string)');
 CL.AddDelphiFunction('Function IniReadInteger( IniFile : TObject; const Section, Ident : string; Default : Longint) : Longint');
 CL.AddDelphiFunction('Procedure IniWriteInteger( IniFile : TObject; const Section, Ident : string; Value : Longint)');
 CL.AddDelphiFunction('Function IniReadBool( IniFile : TObject; const Section, Ident : string; Default : Boolean) : Boolean');
 CL.AddDelphiFunction('Procedure IniWriteBool( IniFile : TObject; const Section, Ident : string; Value : Boolean)');
 CL.AddDelphiFunction('Procedure IniReadSections( IniFile : TObject; Strings : TStrings)');
 CL.AddDelphiFunction('Procedure IniEraseSection( IniFile : TObject; const Section : string)');
 CL.AddDelphiFunction('Procedure IniDeleteKey( IniFile : TObject; const Section, Ident : string)');
 CL.AddDelphiFunction('Procedure AppBroadcast( Msg, wParam : Longint; lParam : Longint)');
 CL.AddDelphiFunction('Procedure AppBroadcast( Msg, wParam : Word; lParam : Longint)');
 CL.AddDelphiFunction('Procedure AppTaskbarIcons( AppOnly : Boolean)');
 CL.AddDelphiFunction('Procedure InternalSaveGridLayout( Grid : TCustomGrid; IniFile : TObject; const Section : string)');
 CL.AddDelphiFunction('Procedure InternalRestoreGridLayout( Grid : TCustomGrid; IniFile : TObject; const Section : string)');
 CL.AddDelphiFunction('Procedure InternalSaveMDIChildren( MainForm : TForm; IniFile : TObject)');
 CL.AddDelphiFunction('Procedure InternalRestoreMDIChildren( MainForm : TForm; IniFile : TObject)');
end;

(* === run-time registration functions === *)
(*----------------------------------------------------------------------------*)
procedure RIRegister_JvAppUtils_Routines(S: TPSExec);
begin
 S.RegisterDelphiFunction(@GetDefaultSection, 'GetDefaultSection', cdRegister);
 S.RegisterDelphiFunction(@GetDefaultIniData, 'GetDefaultIniData', cdRegister);
 S.RegisterDelphiFunction(@GetDefaultIniData, 'GetDefaultIniData', cdRegister);
 S.RegisterDelphiFunction(@GetDefaultIniName, 'GetDefaultIniName', cdRegister);
 S.RegisterDelphiFunction(@GetDefaultIniRegKey, 'GetDefaultIniRegKey', cdRegister);
 S.RegisterDelphiFunction(@FindForm, 'FindForm', cdRegister);
 S.RegisterDelphiFunction(@FindShowForm, 'FindShowForm', cdRegister);
 S.RegisterDelphiFunction(@ShowDialog, 'ShowDialog', cdRegister);
 S.RegisterDelphiFunction(@InstantiateForm, 'InstantiateForm', cdRegister);
 S.RegisterDelphiFunction(@SaveFormPlacement, 'SaveFormPlacement', cdRegister);
 S.RegisterDelphiFunction(@RestoreFormPlacement, 'RestoreFormPlacement', cdRegister);
 S.RegisterDelphiFunction(@WriteFormPlacementReg, 'WriteFormPlacementReg', cdRegister);
 S.RegisterDelphiFunction(@ReadFormPlacementReg, 'ReadFormPlacementReg', cdRegister);
 S.RegisterDelphiFunction(@SaveMDIChildrenReg, 'SaveMDIChildrenReg', cdRegister);
 S.RegisterDelphiFunction(@RestoreMDIChildrenReg, 'RestoreMDIChildrenReg', cdRegister);
 S.RegisterDelphiFunction(@RestoreGridLayoutReg, 'RestoreGridLayoutReg', cdRegister);
 S.RegisterDelphiFunction(@SaveGridLayoutReg, 'SaveGridLayoutReg', cdRegister);
 S.RegisterDelphiFunction(@SaveFormPlacement, 'SaveFormPlacement', cdRegister);
 S.RegisterDelphiFunction(@RestoreFormPlacement, 'RestoreFormPlacement', cdRegister);
 S.RegisterDelphiFunction(@WriteFormPlacement, 'WriteFormPlacement', cdRegister);
 S.RegisterDelphiFunction(@ReadFormPlacement, 'ReadFormPlacement', cdRegister);
 S.RegisterDelphiFunction(@SaveMDIChildren, 'SaveMDIChildren', cdRegister);
 S.RegisterDelphiFunction(@RestoreMDIChildren, 'RestoreMDIChildren', cdRegister);
 S.RegisterDelphiFunction(@RestoreGridLayout, 'RestoreGridLayout', cdRegister);
 S.RegisterDelphiFunction(@SaveGridLayout, 'SaveGridLayout', cdRegister);
 S.RegisterDelphiFunction(@GetUniqueFileNameInDir, 'GetUniqueFileNameInDir', cdRegister);
 S.RegisterDelphiFunction(@StrToIniStr, 'StrToIniStr', cdRegister);
 S.RegisterDelphiFunction(@IniStrToStr, 'IniStrToStr', cdRegister);
 S.RegisterDelphiFunction(@IniReadString, 'IniReadString', cdRegister);
 S.RegisterDelphiFunction(@IniWriteString, 'IniWriteString', cdRegister);
 S.RegisterDelphiFunction(@IniReadInteger, 'IniReadInteger', cdRegister);
 S.RegisterDelphiFunction(@IniWriteInteger, 'IniWriteInteger', cdRegister);
 S.RegisterDelphiFunction(@IniReadBool, 'IniReadBool', cdRegister);
 S.RegisterDelphiFunction(@IniWriteBool, 'IniWriteBool', cdRegister);
 S.RegisterDelphiFunction(@IniReadSections, 'IniReadSections', cdRegister);
 S.RegisterDelphiFunction(@IniEraseSection, 'IniEraseSection', cdRegister);
 S.RegisterDelphiFunction(@IniDeleteKey, 'IniDeleteKey', cdRegister);
 S.RegisterDelphiFunction(@AppBroadcast, 'AppBroadcast', cdRegister);
 S.RegisterDelphiFunction(@AppBroadcast, 'AppBroadcast', cdRegister);
 S.RegisterDelphiFunction(@AppTaskbarIcons, 'AppTaskbarIcons', cdRegister);
 S.RegisterDelphiFunction(@InternalSaveGridLayout, 'InternalSaveGridLayout', cdRegister);
 S.RegisterDelphiFunction(@InternalRestoreGridLayout, 'InternalRestoreGridLayout', cdRegister);
 S.RegisterDelphiFunction(@InternalSaveMDIChildren, 'InternalSaveMDIChildren', cdRegister);
 S.RegisterDelphiFunction(@InternalRestoreMDIChildren, 'InternalRestoreMDIChildren', cdRegister);
end;

 
 
{ TPSImport_JvAppUtils }
(*----------------------------------------------------------------------------*)
procedure TPSImport_JvAppUtils.CompileImport1(CompExec: TPSScript);
begin
  SIRegister_JvAppUtils(CompExec.Comp);
end;
(*----------------------------------------------------------------------------*)
procedure TPSImport_JvAppUtils.ExecImport1(CompExec: TPSScript; const ri: TPSRuntimeClassImporter);
begin
  //RIRegister_JvAppUtils(ri);
  RIRegister_JvAppUtils_Routines(CompExec.Exec); // comment it if no routines
end;
(*----------------------------------------------------------------------------*)
 
 
end.
