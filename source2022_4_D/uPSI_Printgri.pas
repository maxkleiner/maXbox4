unit uPSI_Printgri;
{
This file has been generated by UnitParser v0.7, written by M. Knight
and updated by NP. v/d Spek and George Birbilis. 
Source Code from Carlo Kok has been used to implement various sections of
UnitParser. Components of ROPS are used in the construction of UnitParser,
code implementing the class wrapper is taken from Carlo Kok's conv utility

}
interface
 
uses
   SysUtils
  ,Classes
  ,uPSComponent
  ,uPSRuntime
  ,uPSCompiler
  ;
 
type 
(*----------------------------------------------------------------------------*)
  TPSImport_Printgri = class(TPSPlugin)
  protected
    procedure CompileImport1(CompExec: TPSScript); override;
    procedure ExecImport1(CompExec: TPSScript; const ri: TPSRuntimeClassImporter); override;
  end;
 
 
{ compile-time registration functions }
procedure SIRegister_TPrintGrid(CL: TPSPascalCompiler);
procedure SIRegister_Printgri(CL: TPSPascalCompiler);

{ run-time registration functions }
procedure RIRegister_Printgri_Routines(S: TPSExec);
procedure RIRegister_TPrintGrid(CL: TPSRuntimeClassImporter);
procedure RIRegister_Printgri(CL: TPSRuntimeClassImporter);

procedure Register;

implementation


uses
   WinTypes
  ,WinProcs
  ,Messages
  ,Graphics
  ,Controls
  ,Forms
  ,Dialogs
  ,DBGrids
  ,Printgri
  ;
 
 
procedure Register;
begin
  RegisterComponents('Pascal Script', [TPSImport_Printgri]);
end;

(* === compile-time registration functions === *)
(*----------------------------------------------------------------------------*)
procedure SIRegister_TPrintGrid(CL: TPSPascalCompiler);
begin
  //with RegClassS(CL,'TComponent', 'TPrintGrid') do
  with CL.AddClassN(CL.FindClass('TComponent'),'TPrintGrid') do
  begin
    RegisterMethod('Constructor Create( AOwner : TComponent)');
    RegisterMethod('Procedure Print');
    RegisterMethod('Procedure PrintDialog');
    RegisterProperty('Margins', 'Integer Integer', iptrw);
    RegisterProperty('TitleFont', 'TFont', iptrw);
    RegisterProperty('HeaderFont', 'TFont', iptrw);
    RegisterProperty('LinesFont', 'TFont', iptrw);
    RegisterProperty('DBGrid', 'TDBGrid', iptrw);
    RegisterProperty('PrintAdmTitle', 'String', iptrw);
    RegisterProperty('HeaderInTitle', 'Boolean', iptrw);
    RegisterProperty('Header', 'String', iptrw);
    RegisterProperty('HeaderAlignment', 'TAlignment', iptrw);
    RegisterProperty('ToScreen', 'Boolean', iptrw);
    RegisterProperty('ScreenViewer', 'String', iptrw);
    RegisterProperty('FromPage', 'Longint', iptrw);
    RegisterProperty('ToPage', 'Longint', iptrw);
    RegisterProperty('Border', 'Boolean', iptrw);
    RegisterProperty('ColLines', 'Boolean', iptrw);
    RegisterProperty('RowLines', 'Boolean', iptrw);
    RegisterProperty('AlignedTitles', 'Boolean', iptrw);
    RegisterProperty('HorizontalGap', 'Integer', iptrw);
    RegisterProperty('VerticalGap', 'Integer', iptrw);
    RegisterProperty('PageNumberPos', 'TPageNumberPos', iptrw);
    RegisterProperty('PageNumberLabel', 'String', iptrw);
  end;
end;

(*----------------------------------------------------------------------------*)
procedure SIRegister_Printgri(CL: TPSPascalCompiler);
begin
 CL.AddConstantN('MaxPages','LongInt').SetInt( 1000);
 CL.AddConstantN('MaxCols','LongInt').SetInt( 100);
 CL.AddConstantN('TopMargin','LongInt').SetInt( 1);
 CL.AddConstantN('BottomMargin','LongInt').SetInt( 2);
 CL.AddConstantN('LeftMargin','LongInt').SetInt( 3);
 CL.AddConstantN('RightMargin','LongInt').SetInt( 4);
  CL.AddTypeS('TPageNumberPos', '( pnNone, pnTopLeft, pnTopCenter, pnTopRight, '
   +'pnBotLeft, pnBotCenter, pnBotRight )');
  SIRegister_TPrintGrid(CL);
 CL.AddDelphiFunction('Procedure Register');
end;

(* === run-time registration functions === *)
(*----------------------------------------------------------------------------*)
procedure TPrintGridPageNumberLabel_W(Self: TPrintGrid; const T: String);
begin Self.PageNumberLabel := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridPageNumberLabel_R(Self: TPrintGrid; var T: String);
begin T := Self.PageNumberLabel; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridPageNumberPos_W(Self: TPrintGrid; const T: TPageNumberPos);
begin Self.PageNumberPos := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridPageNumberPos_R(Self: TPrintGrid; var T: TPageNumberPos);
begin T := Self.PageNumberPos; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridVerticalGap_W(Self: TPrintGrid; const T: Integer);
begin Self.VerticalGap := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridVerticalGap_R(Self: TPrintGrid; var T: Integer);
begin T := Self.VerticalGap; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHorizontalGap_W(Self: TPrintGrid; const T: Integer);
begin Self.HorizontalGap := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHorizontalGap_R(Self: TPrintGrid; var T: Integer);
begin T := Self.HorizontalGap; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridAlignedTitles_W(Self: TPrintGrid; const T: Boolean);
begin Self.AlignedTitles := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridAlignedTitles_R(Self: TPrintGrid; var T: Boolean);
begin T := Self.AlignedTitles; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridRowLines_W(Self: TPrintGrid; const T: Boolean);
begin Self.RowLines := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridRowLines_R(Self: TPrintGrid; var T: Boolean);
begin T := Self.RowLines; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridColLines_W(Self: TPrintGrid; const T: Boolean);
begin Self.ColLines := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridColLines_R(Self: TPrintGrid; var T: Boolean);
begin T := Self.ColLines; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridBorder_W(Self: TPrintGrid; const T: Boolean);
begin Self.Border := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridBorder_R(Self: TPrintGrid; var T: Boolean);
begin T := Self.Border; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridToPage_W(Self: TPrintGrid; const T: Longint);
begin Self.ToPage := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridToPage_R(Self: TPrintGrid; var T: Longint);
begin T := Self.ToPage; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridFromPage_W(Self: TPrintGrid; const T: Longint);
begin Self.FromPage := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridFromPage_R(Self: TPrintGrid; var T: Longint);
begin T := Self.FromPage; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridScreenViewer_W(Self: TPrintGrid; const T: String);
begin Self.ScreenViewer := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridScreenViewer_R(Self: TPrintGrid; var T: String);
begin T := Self.ScreenViewer; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridToScreen_W(Self: TPrintGrid; const T: Boolean);
begin Self.ToScreen := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridToScreen_R(Self: TPrintGrid; var T: Boolean);
begin T := Self.ToScreen; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeaderAlignment_W(Self: TPrintGrid; const T: TAlignment);
begin Self.HeaderAlignment := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeaderAlignment_R(Self: TPrintGrid; var T: TAlignment);
begin T := Self.HeaderAlignment; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeader_W(Self: TPrintGrid; const T: String);
begin Self.Header := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeader_R(Self: TPrintGrid; var T: String);
begin T := Self.Header; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeaderInTitle_W(Self: TPrintGrid; const T: Boolean);
begin Self.HeaderInTitle := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeaderInTitle_R(Self: TPrintGrid; var T: Boolean);
begin T := Self.HeaderInTitle; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridPrintAdmTitle_W(Self: TPrintGrid; const T: String);
begin Self.PrintAdmTitle := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridPrintAdmTitle_R(Self: TPrintGrid; var T: String);
begin T := Self.PrintAdmTitle; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridDBGrid_W(Self: TPrintGrid; const T: TDBGrid);
begin Self.DBGrid := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridDBGrid_R(Self: TPrintGrid; var T: TDBGrid);
begin T := Self.DBGrid; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridLinesFont_W(Self: TPrintGrid; const T: TFont);
begin Self.LinesFont := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridLinesFont_R(Self: TPrintGrid; var T: TFont);
begin T := Self.LinesFont; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeaderFont_W(Self: TPrintGrid; const T: TFont);
begin Self.HeaderFont := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridHeaderFont_R(Self: TPrintGrid; var T: TFont);
begin T := Self.HeaderFont; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridTitleFont_W(Self: TPrintGrid; const T: TFont);
begin Self.TitleFont := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridTitleFont_R(Self: TPrintGrid; var T: TFont);
begin T := Self.TitleFont; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridMargins_W(Self: TPrintGrid; const T: Integer; const t1: Integer);
begin Self.Margins[t1] := T; end;

(*----------------------------------------------------------------------------*)
procedure TPrintGridMargins_R(Self: TPrintGrid; var T: Integer; const t1: Integer);
begin T := Self.Margins[t1]; end;

(*----------------------------------------------------------------------------*)
procedure RIRegister_Printgri_Routines(S: TPSExec);
begin
 S.RegisterDelphiFunction(@Register, 'Register', cdRegister);
end;

(*----------------------------------------------------------------------------*)
procedure RIRegister_TPrintGrid(CL: TPSRuntimeClassImporter);
begin
  with CL.Add(TPrintGrid) do
  begin
    RegisterConstructor(@TPrintGrid.Create, 'Create');
    RegisterMethod(@TPrintGrid.Print, 'Print');
    RegisterMethod(@TPrintGrid.PrintDialog, 'PrintDialog');
    RegisterPropertyHelper(@TPrintGridMargins_R,@TPrintGridMargins_W,'Margins');
    RegisterPropertyHelper(@TPrintGridTitleFont_R,@TPrintGridTitleFont_W,'TitleFont');
    RegisterPropertyHelper(@TPrintGridHeaderFont_R,@TPrintGridHeaderFont_W,'HeaderFont');
    RegisterPropertyHelper(@TPrintGridLinesFont_R,@TPrintGridLinesFont_W,'LinesFont');
    RegisterPropertyHelper(@TPrintGridDBGrid_R,@TPrintGridDBGrid_W,'DBGrid');
    RegisterPropertyHelper(@TPrintGridPrintAdmTitle_R,@TPrintGridPrintAdmTitle_W,'PrintAdmTitle');
    RegisterPropertyHelper(@TPrintGridHeaderInTitle_R,@TPrintGridHeaderInTitle_W,'HeaderInTitle');
    RegisterPropertyHelper(@TPrintGridHeader_R,@TPrintGridHeader_W,'Header');
    RegisterPropertyHelper(@TPrintGridHeaderAlignment_R,@TPrintGridHeaderAlignment_W,'HeaderAlignment');
    RegisterPropertyHelper(@TPrintGridToScreen_R,@TPrintGridToScreen_W,'ToScreen');
    RegisterPropertyHelper(@TPrintGridScreenViewer_R,@TPrintGridScreenViewer_W,'ScreenViewer');
    RegisterPropertyHelper(@TPrintGridFromPage_R,@TPrintGridFromPage_W,'FromPage');
    RegisterPropertyHelper(@TPrintGridToPage_R,@TPrintGridToPage_W,'ToPage');
    RegisterPropertyHelper(@TPrintGridBorder_R,@TPrintGridBorder_W,'Border');
    RegisterPropertyHelper(@TPrintGridColLines_R,@TPrintGridColLines_W,'ColLines');
    RegisterPropertyHelper(@TPrintGridRowLines_R,@TPrintGridRowLines_W,'RowLines');
    RegisterPropertyHelper(@TPrintGridAlignedTitles_R,@TPrintGridAlignedTitles_W,'AlignedTitles');
    RegisterPropertyHelper(@TPrintGridHorizontalGap_R,@TPrintGridHorizontalGap_W,'HorizontalGap');
    RegisterPropertyHelper(@TPrintGridVerticalGap_R,@TPrintGridVerticalGap_W,'VerticalGap');
    RegisterPropertyHelper(@TPrintGridPageNumberPos_R,@TPrintGridPageNumberPos_W,'PageNumberPos');
    RegisterPropertyHelper(@TPrintGridPageNumberLabel_R,@TPrintGridPageNumberLabel_W,'PageNumberLabel');
  end;
end;

(*----------------------------------------------------------------------------*)
procedure RIRegister_Printgri(CL: TPSRuntimeClassImporter);
begin
  RIRegister_TPrintGrid(CL);
end;

 
 
{ TPSImport_Printgri }
(*----------------------------------------------------------------------------*)
procedure TPSImport_Printgri.CompileImport1(CompExec: TPSScript);
begin
  SIRegister_Printgri(CompExec.Comp);
end;
(*----------------------------------------------------------------------------*)
procedure TPSImport_Printgri.ExecImport1(CompExec: TPSScript; const ri: TPSRuntimeClassImporter);
begin
  RIRegister_Printgri(ri);
  RIRegister_Printgri_Routines(CompExec.Exec); // comment it if no routines
end;
(*----------------------------------------------------------------------------*)
 
 
end.
